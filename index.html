from pathlib import Path

# Neuer HTML-Inhalt mit besserer Instruktion und AnfÃ¤nger-Fehlertests
improved_html = """<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Learn to Code â€“ Start</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.9/codemirror.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.9/codemirror.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.9/mode/javascript/javascript.min.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    #editor { height: 200px; }
    #output { background: #f0f0f0; padding: 10px; margin-top: 10px; white-space: pre-wrap; }
    #startScreen, #lessonSection { display: none; }
  </style>
  <script>
    let editor;

    async function validateLicenseKey() {
      if (true) {
        localStorage.setItem("validLicense", "true");
        document.getElementById("loginSection").style.display = "none";
        document.getElementById("startScreen").style.display = "block";
      } else {
        alert("Invalid license key. Please check your Gumroad purchase.");
      }
    }

    function showLesson() {
      document.getElementById("startScreen").style.display = "none";
      document.getElementById("lessonSection").style.display = "block";
      loadLesson();
    }

    function loadLesson() {
      document.getElementById("lessonTitle").innerText = "Lesson 1: Hello World";
      document.getElementById("lessonText").innerText =
        "In programming, we use console.log() to print something on the screen.\\n\\n" +
        "Your task: Print the phrase Hello, World!\\n\\n" +
        "âœ… Tip: Wrap the text in quotation marks like this:\\n" +
        'console.log("Hello, World!");';

      editor = CodeMirror.fromTextArea(document.getElementById("editor"), {
        lineNumbers: true,
        mode: "javascript",
        theme: "default"
      });

      editor.setValue("// Type your code here...");
    }

    function runCode() {
      const code = editor.getValue();
      let userOutput = "";
      const log = console.log;
      console.log = (...args) => userOutput += args.join(" ") + "\\n";

      try {
        eval(code);
        console.log = log;

        if (!code.includes("console.log")) {
          document.getElementById("output").textContent = "âŒ You must use console.log to print output.";
          return;
        }
        if (!code.includes('"') && !code.includes("'")) {
          document.getElementById("output").textContent = "âŒ Your text must be inside quotation marks.";
          return;
        }

        const trimmedOutput = userOutput.trim();
        if (trimmedOutput === "Hello, World!") {
          document.getElementById("output").textContent = "âœ… Correct! Well done.";
        } else {
          document.getElementById("output").textContent =
            `âš ï¸ Your output was: "${trimmedOutput}". It should be exactly: "Hello, World!"`;
        }
      } catch (e) {
        console.log = log;
        document.getElementById("output").textContent = "âŒ Error: " + e.message + "\\n" +
          "ðŸ’¡ Tip: Make sure your text is in quotation marks. Example: console.log(\\"Hello, World!\\");";
      }
    }

    window.onload = () => {
      if (localStorage.getItem("validLicense") === "true") {
        document.getElementById("loginSection").style.display = "none";
        document.getElementById("startScreen").style.display = "block";
      }
    };
  </script>
</head>
<body>
  <div id="loginSection">
    <h2>Enter your Gumroad License Key</h2>
    <input type="text" id="licenseKey" placeholder="Your license key">
    <button onclick="validateLicenseKey()">Access Course</button>
  </div>

  <div id="startScreen">
    <h1>Welcome to Learn to Code</h1>
    <p>Programming means telling a computer what to do â€“ step by step.</p>
    <p>In this course, you'll learn JavaScript from scratch. No experience needed.</p>
    <button onclick="showLesson()">Start Lesson 1</button>
  </div>

  <div id="lessonSection">
    <h1 id="lessonTitle"></h1>
    <pre id="lessonText"></pre>
    <textarea id="editor"></textarea><br>
    <button onclick="runCode()">Run Code</button>
    <pre id="output"></pre>
  </div>
</body>
</html>
"""

# Pfad definieren
output_file = Path("/mnt/data/learn-to-code-app_better_intro.html")
output_file.write_text(improved_html, encoding="utf-8")

output_file.name
